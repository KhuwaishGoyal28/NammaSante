{% extends "base.html" %}
{% block title %}Waste Management{% endblock %}
{% block content %}
<div class="row justify-content-center">
  <div class="col-12">
    <h2 class="text-center mb-5 text-success"><i class="bi bi-recycle"></i> Waste Management</h2>

    <!-- Add Waste Data Form -->
    <div class="card shadow-lg border-0 rounded-3 mb-5">
      <div class="card-header bg-success text-white">
        <h5 class="mb-0"><i class="bi bi-plus-circle"></i> Add Waste Management Details</h5>
      </div>
      <div class="card-body">
        <form method="POST" action="{{ url_for('waste_management') }}">
          <div class="row g-3">
            <div class="col-md-4">
              <label for="farmer_name" class="form-label">Farmer Name</label>
              <input type="text" class="form-control" id="farmer_name" name="farmer_name" value="{{ profile.Farmer_Name if profile else '' }}" required>
            </div>
            <div class="col-md-4">
              <label for="crop_name" class="form-label">Crop Name</label>
              <input type="text" class="form-control" id="crop_name" name="crop_name" required>
            </div>
            <div class="col-md-4">
              <label for="waste_quantity" class="form-label">Waste Quantity (kg)</label>
              <input type="number" class="form-control" id="waste_quantity" name="waste_quantity" step="0.01" required>
            </div>
            <div class="col-12">
              <label for="waste_details" class="form-label">Waste Details</label>
              <textarea class="form-control" id="waste_details" name="waste_details" rows="3" placeholder="Describe the type of waste, condition, location, etc." required></textarea>
            </div>
          </div>
          <div class="text-center mt-4">
            <button type="submit" class="btn btn-success btn-lg"><i class="bi bi-plus"></i> Add Waste Data</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Display All Waste Data -->
    <div class="card shadow-lg border-0 rounded-3">
      <div class="card-header bg-success text-white">
        <h5 class="mb-0"><i class="bi bi-list-ul"></i> All Waste Management Entries</h5>
      </div>
      <div class="card-body">
        {% if waste_entries %}
          <div class="table-responsive">
            <table class="table table-striped table-hover">
              <thead class="table-success">
                <tr>
                  <th>Farmer Name</th>
                  <th>Crop Name</th>
                  <th>Waste Quantity (kg)</th>
                  <th>Waste Details</th>
                  <th>Date Added</th>
                </tr>
              </thead>
              <tbody>
                {% for entry in waste_entries %}
                <tr>
                  <td>{{ entry.Farmer_Name }}</td>
                  <td>{{ entry.Crop_Name }}</td>
                  <td>{{ entry.Waste_Quantity }}</td>
                  <td>{{ entry.Waste_Details[:100] }}...</td>
                  <td>{{ entry.Timestamp.strftime('%Y-%m-%d %H:%M') if entry.Timestamp else 'N/A' }}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        {% else %}
          <div class="text-center text-muted py-5">
            <i class="bi bi-inbox display-4 mb-3"></i>
            <p>No waste management entries yet. Add some data above!</p>
          </div>
        {% endif %}
      </div>
    </div>

    <div class="text-center mt-5">
      <a href="{{ url_for('food_chain') }}" class="btn btn-secondary btn-lg px-4"><i class="bi bi-arrow-left"></i> Back to Food Chain</a>
    </div>
  </div>
</div>
{% endblock %}
